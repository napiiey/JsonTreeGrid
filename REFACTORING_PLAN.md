# リファクタリング計画：JsonTreeGridのコード品質向上

## 1. ユーティリティと定数の整理 (低リスク・高効果)
- [ ] 全角/半角を考慮した文字列長計算の共通化
- [ ] マジックナンバー (行高さ、最小カラム幅など) の定数化
- [ ] パス変換処理 (`partsToPath`) を `JsonModel` へ集約

## 2. JsonModel のトラバース処理の共通化 (高密度化)
- [ ] `_traverseAndApply` メソッドの実装
- [ ] `renameKey`, `moveKey`, `insertKey`, `removeKey` を共通処理で書き換え

## 3. GridView の巨大メソッドとイベント処理の刷新 (最重要)
- [ ] `render()` メソッドをカラム定義、ヘッダー生成、テーブル構築のサブメソッドに分割
- [ ] `handleMouseDown` をクリック対象（セル、ヘッダー、インデックス）ごとに分離
- [ ] ヘッダーのイベント処理をデリゲーション（個別の設定から親での一括管理）に移行

## 4. UIコンポーネントの分離と App クラスの整理
- [ ] コンテキストメニュー処理を `ContextMenu` コンポーネントとして抽出
- [ ] `main.js` のキーボードショートカット処理をマップベースの宣言的な記述に変更

## 5. 最終確認とクリーンアップ
- [ ] 既存機能（D&D、編集、Undo/Redo、フィルタリング）の正常動作確認
- [ ] 長すぎるコメントやデバッグ用コードの削除
